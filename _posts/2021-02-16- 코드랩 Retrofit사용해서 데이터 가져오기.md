---
title : "ì½”ë“œë© Retrofitìœ¼ë¡œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°1 "
excerpt : "Retrofit2ê³¼ Moshi ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©í•˜ê¸°"

categories:
  - Android
tags :
  - Kotlin
---


kotlin Retrofit + Moshi ë¡œ ì„œë²„í†µì‹ í•˜ê¸°

íŒ€í”Œí•˜ë©´ì„œ Retrofitë„ ì •ë§ ë§ì´ ì¼ì—ˆëŠ”ë°, ì²˜ìŒë¶€í„° ë‹¤ì‹œ êµ¬í˜„í•˜ë ¤ë‹ˆê¹Œ ê°€ë¬¼ê°€ë¬¼í–ˆë‹¤..ğŸ˜­ ì•„ì˜ˆ ì†ì— ìµì„ë•Œê¹Œì§€ëŠ” ì–¼ë§ˆë‚˜ ì¨ì•¼í• ê¹Œ ã…

---

[ë‹¤ìŒ ì‚¬ì´íŠ¸](https://android-kotlin-fun-mars-server.appspot.com/realestate)ì˜ ê°ì²´ ê°¯ìˆ˜ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì˜ˆì œì´ë‹¤.

ìœ„ì‚¬ì´íŠ¸ë¥¼ ë“¤ì–´ê°€ë©´ price, id, type, img_src key-valueë¡œ ì´ë£¨ì–´ì§„ ê°ì²´ ë°°ì—´ì„ ë³¼ ìˆ˜ ìˆë‹¤.

<img width="292" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-02-15 á„‹á…©á„’á…® 11 53 12" src="https://user-images.githubusercontent.com/53978090/107961246-f9dc6b00-6fe8-11eb-937a-791d5311abb8.png">

ì´ 838ê°œì˜ ê°ì²´ê°€ ìˆë‹¤ê³  í•œë‹¤ã…ã…

> Retrofit ê°ì²´ ìƒì„±í•˜ê¸°

ë¨¼ì € Retrofit ëª¨ë“ˆì„ ì¶”ê°€í•´ì¤€ë‹¤.

**build.gradle(Module)**

~~~
implementation "com.squareup.retrofit2:retrofit:$version_retrofit"  
//    implementation "com.squareup.retrofit2:converter-scalars:$version_retrofit"  
  
  implementation "com.squareup.moshi:moshi-kotlin:$version_moshi"  
  implementation "com.squareup.retrofit2:converter-moshi:$version_retrofit"
~~~

<img width="748" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-02-15 á„‹á…©á„’á…® 11 58 14" src="https://user-images.githubusercontent.com/53978090/107961760-af0f2300-6fe9-11eb-97bb-8de6d4834b14.png">


(ì²˜ìŒ ì•ˆ ì‚¬ì‹¤ì´ì§€ë§Œ $ë’¤ì˜ version~ ì´ê±´ build.gradle(Project)ì—ì„œ ìƒìˆ˜ì²˜ëŸ¼ ì„ ì–¸í•œ ê²ƒì´ì˜€ë‹¤ã….. def ë¡œ ë§¨ìœ„ì— ì„ ì–¸í•´ë†“ëŠ”ê²ƒë„ ì¢‹ì§€ë§Œ í•œëˆˆì— ë³´ê¸°ë„ ì‰½ê³ , ë²„ì „ ë°”ê¿€ë•Œ ê°„ë‹¨í•´ì„œ ì¢‹ì€ ë°©ë²•ì¸ê±°ê°™ë‹¤.)

responseê°€ ê°ì²´ ë¦¬ìŠ¤íŠ¸ê¸° ë•Œë¬¸ì—, ê°ì²´í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.

~~~
class MarsProperty(  
  val id: String,  
        @Json(name = "img_src")  
  val imgSrcUrl : String,  
        val type : String,  
        val price : Double  
)
~~~

ë³¸ê²©ì ìœ¼ë¡œ retrofitì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤! 

1) ì„œë²„ë¥¼ ê°€ì ¸ì˜¬ BASE_URL ì£¼ì†Œë¥¼ ì ì–´ì¤€ë‹¤. (ìœ„ ì‚¬ì´íŠ¸ì˜ ì£¼ì†Œì´ë‹¤.)

~~~
private const val BASE_URL = "https://android-kotlin-fun-mars-server.appspot.com/"
~~~

2) ê·¸ ë‹¤ìŒ retrofit ê°ì²´ë¥¼ ìƒì„±í•´ì¤€ë‹¤.

~~~
private val retrofit = Retrofit.Builder()  
  .addConverterFactory(MoshiConverterFactory.create(moshi))  
  .baseUrl(BASE_URL)  
  .build()
~~~

ì—¬íƒœê» Retrofitì„ ì‚¬ìš©í•˜ë©´ì„œ gsonì»¨ë²„í„°ë§Œ ì‚¬ìš©í•´ë´¤ê³  moshië¼ëŠ” ì»¨ë²„í„°ëŠ” ì²˜ìŒ ë´¤ë‹¤. 

ì°¾ì•„ë³´ë‹ˆ [moshi](https://proandroiddev.com/goodbye-gson-hello-moshi-4e591116231e)ë¡œ ë°”ë€ŒëŠ” ì¶”ì„¸ë¼ê³  í•œë‹¤. 

3) ê·¸ ë‹¤ìŒ GET, POST, DELETE, PUTë“± apië¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ë¥¼ ì ì–´ì¤„ interfaceë¥¼ ë§Œë“ ë‹¤. (ì„œë²„í†µì‹ ì€ ì‹œê°„ì´ ì˜¤ë˜ê±¸ë¦¬ëŠ” ì‘ì—…ì´ê¸° ë•Œë¬¸ì— ì½”ë£¨í‹´ì„ ì‚¬ìš©í•´ì¤¬ë‹¤.)

~~~
interface MarsApiService{  
  @GET("realestate")  
  suspend fun getProperties(): List<MarsProperty>  
}
~~~

4) Retrofitì— ì ‘ê·¼í•´ì£¼ê¸° ìœ„í•´ì„œ  ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤. í•˜ë‚˜ë§Œ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ê³µìš©ê°œì²´ ì‚¬ìš© !

~~~
object MarsApi{  
  //í˜¸ì¶œ ê³„ì‚°ë¹„ìš© ë§ì´ ë“¤ê¸° ë•Œë¬¸ì— ëŠë¦¬ê²Œ ì´ˆê¸°í™” í•¨  
  val retrofitService : MarsApiService by lazy {  
  retrofit.create(MarsApiService::class.java)  
  }  
}
~~~

ë§ˆì§€ë§‰ìœ¼ë¡œ ë§Œë“¤ì–´ë‘” retrofit ê°ì²´ì™€ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë©´ ëœë‹¤. í•¨ìˆ˜ì— suspendë¥¼ ë¶™ì—¬ì¤¬ê¸° ë•Œë¬¸ì— viewModel.Scope ~ ë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤.

~~~
private fun getMarsRealEstateProperties() {  
  //callback ëŒ€ì‹  ì½”ë£¨í‹´ ì‚¬ìš© ?  viewModelScope.launch {  
  try{  
  val listResult = MarsApi.retrofitService.getProperties()  
  _response.value = "Success: ${listResult.size} Mars properties retrieved"  
  }catch (e: Exception){  
  _response.value = e.message  
        }  
  }  
  
}
~~~

*manifestsì—

~~~
<uses-permission android:name="android.permission.INTERNET"/>
~~~

ì´ê±°ê¹Œì§€ ì ì–´ì£¼ë©´ 

ì„œë²„í†µì‹  ë ! 

---

**ì°¸ê³ **

ì½”ë“œë© :<https://developer.android.com/codelabs/kotlin-android-training-internet-data?index=..%2F..android-kotlin-fundamentals#0>




